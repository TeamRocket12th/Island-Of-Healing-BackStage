import{d as k,r as g,m as v,c as s,b as t,k as h,s as _,F as m,e as b,o as a,t as p,v as C,x as I,y as S}from"./index-ed710b8a.js";const y=r=>(I("data-v-841c5fba"),r=r(),S(),r),D=y(()=>t("h1",{class:"text-3xl mb-4"},"新增費用單",-1)),$={class:"flex mb-10"},E={class:"flex flex-col"},P={class:"-my-2 overflow-x-auto sm:-mx-6 lg:-mx-8"},U={class:"py-2 align-middle inline-block min-w-full sm:px-6 lg:px-8"},V={class:"shadow overflow-hidden border-b border-gray-200 sm:rounded-lg"},F={class:"min-w-full divide-y divide-gray-200"},A=y(()=>t("thead",{class:"bg-gray-50"},[t("tr",null,[t("th",{scope:"col",class:"px-6 py-3 text-left font-medium text-gray-500 uppercase tracking-wider"}," 筆數 "),t("th",{scope:"col",class:"px-6 py-3 text-left font-medium text-gray-500 uppercase tracking-wider"}," 費用單編號 "),t("th",{scope:"col",class:"px-6 py-3 text-left font-medium text-gray-500 uppercase tracking-wider"}," 作家編號 "),t("th",{scope:"col",class:"px-6 py-3 text-left font-medium text-gray-500 uppercase tracking-wider"}," 費用 "),t("th",{scope:"col",class:"px-6 py-3 text-left font-medium text-gray-500 uppercase tracking-wider"}," 是否已完成付款 "),t("th",{scope:"col",class:"px-6 py-3 text-left font-medium text-gray-500 uppercase tracking-wider"}," 費用單創建日期 "),t("th",{scope:"col",class:"px-6 py-3 text-left font-medium text-gray-500 uppercase tracking-wider"}," 付款日期 "),t("th",{scope:"col",class:"px-6 py-3 text-left font-medium text-gray-500 uppercase tracking-wider"}," 編輯 ")])],-1)),B={class:"bg-white divide-y divide-gray-200"},M={class:"px-6 py-4 whitespace-nowrap text-gray-500"},j={key:0,class:"px-6 py-4 whitespace-nowrap"},z=["onUpdate:modelValue"],O={key:1,class:"px-6 py-4 whitespace-nowrap"},T={class:"px-6 py-4 whitespace-nowrap text-gray-500"},N={key:2,class:"px-6 py-4 whitespace-nowrap"},J=["onUpdate:modelValue"],L={key:3,class:"px-6 py-4 whitespace-nowrap text-gray-500"},W={key:4,class:"px-6 py-4 whitespace-nowrap"},Y=["onUpdate:modelValue"],q=y(()=>t("option",{value:!0},"是",-1)),G=y(()=>t("option",{value:!1},"否",-1)),H=[q,G],K={key:5,class:"px-6 py-4 whitespace-nowrap text-gray-500"},Q={key:0},R={key:1},X={class:"px-6 py-4 whitespace-nowrap text-gray-500"},Z={key:6,class:"px-6 py-4 whitespace-nowrap"},ee=["onUpdate:modelValue"],te={key:7,class:"px-6 py-4 whitespace-nowrap text-gray-500"},oe={class:"px-6 py-4 whitespace-nowrap text-gray-500"},se=["onClick"],ae=["onClick"],ne=k({__name:"FeeCalculate",setup(r){const d="https://islandofhealing.rocket-coding.com/api",l=g([]),u=async()=>{const n=localStorage.getItem("token");if(n)try{const e=await(await fetch(`${d}/expense/get`,{headers:{"Content-type":"application/json",Authorization:`Bearer ${n}`}})).json();if(e.StatusCode===200)l.value=e.ExpenseData;else throw new Error(`發生錯誤 ${e.Message}`)}catch(o){console.log(o)}};v(u);const i=g(""),w=async()=>{const n=localStorage.getItem("token");if(n){if(!i.value){alert("請輸入作家編號");return}try{const e=await(await fetch(`${d}/expense/create?userid=${i.value}`,{method:"POST",headers:{"Content-type":"application/json",Authorization:`Bearer ${n}`}})).json();if(e.StatusCode===200)l.value=e.ExpenseData,u();else throw new Error(`發生錯誤 ${e.Message}`)}catch(o){alert(o)}}},f=async n=>{const o=localStorage.getItem("token");if(o)try{const c=await(await fetch(`${d}/expense/update`,{method:"PUT",headers:{"Content-type":"application/json",Authorization:`Bearer ${o}`},body:JSON.stringify({Id:n.Id,ContractId:n.ContractId,PayDate:n.PayDate,Amount:n.Amount,Paid:n.Paid})})).json();if(c.StatusCode===200)l.value=c.ExpenseData,u();else throw new Error(`發生錯誤 ${c.Message}`)}catch(e){console.log(e)}},x=n=>{const o=new Date(n);return`${o.getFullYear()}-${(o.getMonth()+1).toString().padStart(2,"0")}-${o.getDate().toString().padStart(2,"0")}`};return(n,o)=>(a(),s(m,null,[D,t("div",$,[h(t("input",{class:"px-2 border shadow-md","onUpdate:modelValue":o[0]||(o[0]=e=>i.value=e),placeholder:"請輸入作家編號",type:"text"},null,512),[[_,i.value]]),t("button",{type:"button",class:"h-9 px-4 bg-blue-900 text-white hover:bg-blue-800 rounded-md ml-2",onClick:w}," 新增 ")]),t("div",E,[t("div",P,[t("div",U,[t("div",V,[t("table",F,[A,t("tbody",B,[(a(!0),s(m,null,b(l.value,e=>(a(),s("tr",{key:e.Id},[t("td",M,p(e.Id),1),e.Edit?(a(),s("td",j,[h(t("input",{"onUpdate:modelValue":c=>e.ContractId=c,class:"border"},null,8,z),[[_,e.ContractId]])])):(a(),s("td",O,p(e.ContractId),1)),t("td",T,p(e.WriterId),1),e.Edit?(a(),s("td",N,[h(t("input",{"onUpdate:modelValue":c=>e.Amount=c,class:"border w-20"},null,8,J),[[_,e.Amount]])])):(a(),s("td",L,p(e.Amount),1)),e.Edit?(a(),s("td",W,[h(t("select",{"onUpdate:modelValue":c=>e.Paid=c,class:"border w-20"},H,8,Y),[[C,e.Paid]])])):(a(),s("td",K,[e.Paid===!0?(a(),s("p",Q,"是")):(a(),s("p",R,"否"))])),t("td",X,p(x(e.InitDate)),1),e.Edit?(a(),s("td",Z,[h(t("input",{"onUpdate:modelValue":c=>e.PayDate=c,class:"border w-[220px]"},null,8,ee),[[_,e.PayDate]])])):(a(),s("td",te,p(x(e.PayDate)),1)),t("td",oe,[e.Edit?(a(),s("button",{key:1,type:"button",class:"p-2 h-10 px-4 bg-emerald-600 text-white rounded-md",onClick:c=>f(e)}," 完成 ",8,ae)):(a(),s("button",{key:0,type:"button",class:"h-10 px-4 bg-sky-800 text-white rounded-md",onClick:c=>e.Edit=!0}," 編輯 ",8,se))])]))),128))])])])])])])],64))}});const ce=(r,d)=>{const l=r.__vccOpts||r;for(const[u,i]of d)l[u]=i;return l},le=ce(ne,[["__scopeId","data-v-841c5fba"]]);export{le as default};
