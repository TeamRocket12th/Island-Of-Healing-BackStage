import{e as k,f as m,l as b,c as a,a as t,j as l,p as d,F as w,h as v,o as n,t as r,v as C,q as I,s as D}from"./index-4cf03251.js";import{_ as S}from"./_plugin-vue_export-helper-c27b6911.js";const u=i=>(I("data-v-05d988ab"),i=i(),D(),i),$=u(()=>t("h1",{class:"text-3xl mb-4"},"新增費用單",-1)),E={class:"flex mb-10"},P={class:"flex flex-col"},U={class:"-my-2 overflow-x-auto sm:-mx-6 lg:-mx-8"},V={class:"py-2 align-middle inline-block min-w-full sm:px-6 lg:px-8"},F={class:"shadow overflow-hidden border-b border-gray-200 sm:rounded-lg"},A={class:"min-w-full divide-y divide-gray-200"},j=u(()=>t("thead",{class:"bg-gray-50"},[t("tr",null,[t("th",{scope:"col",class:"px-6 py-3 text-left font-medium text-gray-500 uppercase tracking-wider"}," 筆數 "),t("th",{scope:"col",class:"px-6 py-3 text-left font-medium text-gray-500 uppercase tracking-wider"}," 費用單編號 "),t("th",{scope:"col",class:"px-6 py-3 text-left font-medium text-gray-500 uppercase tracking-wider"}," 作家編號 "),t("th",{scope:"col",class:"px-6 py-3 text-left font-medium text-gray-500 uppercase tracking-wider"}," 費用 "),t("th",{scope:"col",class:"px-6 py-3 text-left font-medium text-gray-500 uppercase tracking-wider"}," 是否已完成付款 "),t("th",{scope:"col",class:"px-6 py-3 text-left font-medium text-gray-500 uppercase tracking-wider"}," 費用單創建日期 "),t("th",{scope:"col",class:"px-6 py-3 text-left font-medium text-gray-500 uppercase tracking-wider"}," 付款日期 "),t("th",{scope:"col",class:"px-6 py-3 text-left font-medium text-gray-500 uppercase tracking-wider"}," 編輯 ")])],-1)),B={class:"bg-white divide-y divide-gray-200"},M={class:"px-6 py-4 whitespace-nowrap text-gray-500"},z={key:0,class:"px-6 py-4 whitespace-nowrap"},T=["onUpdate:modelValue"],N=["onClick"],O={class:"px-6 py-4 whitespace-nowrap text-gray-500"},q={key:2,class:"px-6 py-4 whitespace-nowrap"},J=["onUpdate:modelValue"],L={key:3,class:"px-6 py-4 whitespace-nowrap text-gray-500"},W={key:4,class:"px-6 py-4 whitespace-nowrap"},Y=["onUpdate:modelValue"],G=u(()=>t("option",{value:!0},"是",-1)),H=u(()=>t("option",{value:!1},"否",-1)),K=[G,H],Q={key:5,class:"px-6 py-4 whitespace-nowrap text-gray-500"},R={key:0},X={key:1},Z={class:"px-6 py-4 whitespace-nowrap text-gray-500"},ee={key:6,class:"px-6 py-4 whitespace-nowrap"},te=["onUpdate:modelValue"],oe={key:7,class:"px-6 py-4 whitespace-nowrap text-gray-500"},se={class:"px-6 py-4 whitespace-nowrap text-gray-500"},ae=["onClick"],ne=["onClick"],ce=k({__name:"FeeCalculate",setup(i){const h="https://islandofhealing.rocket-coding.com/api",p=m([]),_=async()=>{const c=localStorage.getItem("token");if(c)try{const e=await(await fetch(`${h}/expense/get`,{headers:{"Content-type":"application/json",Authorization:`Bearer ${c}`}})).json();if(console.log(e),e.StatusCode===200)console.log(e.ExpenseData),p.value=e.ExpenseData;else throw new Error(`發生錯誤 ${e.Message}`)}catch(o){console.log(o)}};b(_);const x=m(""),f=async()=>{const c=localStorage.getItem("token");if(c)try{const e=await(await fetch(`${h}/expense/create?userid=${x.value}`,{method:"POST",headers:{"Content-type":"application/json",Authorization:`Bearer ${c}`}})).json();if(console.log(e),e.StatusCode===200)console.log(e.ExpenseData),p.value=e.ExpenseData,_();else throw new Error(`發生錯誤 ${e.Message}`)}catch(o){console.log(o)}},y=async c=>{const o=localStorage.getItem("token");if(o)try{const s=await(await fetch(`${h}/expense/update`,{method:"PUT",headers:{"Content-type":"application/json",Authorization:`Bearer ${o}`},body:JSON.stringify({Id:c.Id,ContractId:c.ContractId,PayDate:c.PayDate,Amount:c.Amount,Paid:c.Paid})})).json();if(console.log(s),s.StatusCode===200)p.value=s.ExpenseData,_();else throw new Error(`發生錯誤 ${s.Message}`)}catch(e){console.log(e)}},g=c=>{const o=new Date(c);return`${o.getFullYear()}-${(o.getMonth()+1).toString().padStart(2,"0")}-${o.getDate().toString().padStart(2,"0")}`};return(c,o)=>(n(),a(w,null,[$,t("div",E,[l(t("input",{class:"px-2 border shadow-md","onUpdate:modelValue":o[0]||(o[0]=e=>x.value=e),placeholder:"請輸入作家編號",type:"text"},null,512),[[d,x.value]]),t("button",{class:"shadow-lg border ml-2 h-[40px] px-4 bg-blue-900 text-white rounded",onClick:f},"新增")]),t("div",P,[t("div",U,[t("div",V,[t("div",F,[t("table",A,[j,t("tbody",B,[(n(!0),a(w,null,v(p.value,e=>(n(),a("tr",{key:e.Id},[t("td",M,r(e.Id),1),e.Edit?(n(),a("td",z,[l(t("input",{"onUpdate:modelValue":s=>e.ContractId=s,class:"border"},null,8,T),[[d,e.ContractId]])])):(n(),a("td",{key:1,class:"px-6 py-4 whitespace-nowrap underline text-blue-500 cursor-pointer",onClick:s=>y(e)},r(e.ContractId),9,N)),t("td",O,r(e.WriterId),1),e.Edit?(n(),a("td",q,[l(t("input",{"onUpdate:modelValue":s=>e.Amount=s,class:"border w-20"},null,8,J),[[d,e.Amount]])])):(n(),a("td",L,r(e.Amount),1)),e.Edit?(n(),a("td",W,[l(t("select",{"onUpdate:modelValue":s=>e.Paid=s,class:"border w-20"},K,8,Y),[[C,e.Paid]])])):(n(),a("td",Q,[e.Paid===!0?(n(),a("p",R,"是")):(n(),a("p",X,"否"))])),t("td",Z,r(g(e.InitDate)),1),e.Edit?(n(),a("td",ee,[l(t("input",{"onUpdate:modelValue":s=>e.PayDate=s,class:"border w-[220px]"},null,8,te),[[d,e.PayDate]])])):(n(),a("td",oe,r(g(e.PayDate)),1)),t("td",se,[e.Edit?(n(),a("button",{key:1,class:"border ml-2 p-2 h-[40px] px-4 bg-blue-900 text-white rounded",onClick:s=>y(e)},"完成",8,ne)):(n(),a("button",{key:0,class:"border ml-2 p-2 h-[40px] px-4 bg-blue-900 text-white rounded",onClick:s=>e.Edit=!0},"編輯",8,ae))])]))),128))])])])])])])],64))}});const ie=S(ce,[["__scopeId","data-v-05d988ab"]]);export{ie as default};
