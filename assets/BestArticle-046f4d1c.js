import{S as u}from"./sweetalert2.all-9555961e.js";import{r as x,d as f,m as _,c as h,q as w,b as e,F as k,e as b,j as A,o as g,t as c,n as S}from"./index-ed710b8a.js";const v=()=>{const y="https://islandofhealing.rocket-coding.com/api",n=x([]);return{getAllArticles:async()=>{const i=localStorage.getItem("token");if(i)try{const l=await(await fetch(`${y}/administratorarticles/get`,{headers:{"Content-type":"application/json",Authorization:`Bearer ${i}`}})).json();if(l.StatusCode===200)n.value=l.ArticlesData.map(m=>({...m})).reverse();else throw new Error(`發生錯誤 ${l.Message}`)}catch(p){console.error(p)}},reviewArticles:n}},$={key:0,class:"flex flex-col"},B={class:"-my-2 overflow-x-auto sm:-mx-6 lg:-mx-8"},C={class:"py-2 align-middle inline-block min-w-full sm:px-6 lg:px-8"},I={class:"shadow overflow-hidden border-b border-gray-200 sm:rounded-lg"},j={class:"min-w-full divide-y divide-gray-200"},z=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{scope:"col",class:"px-6 py-3 text-left font-medium text-gray-500 uppercase tracking-wider"}," ID "),e("th",{scope:"col",class:"px-6 py-3 text-left font-medium text-gray-500 uppercase tracking-wider"}," 標題 "),e("th",{scope:"col",class:"px-6 py-3 text-left font-medium text-gray-500 uppercase tracking-wider"}," 創建日期 "),e("th",{scope:"col",class:"px-6 py-3 text-left font-medium text-gray-500 uppercase tracking-wider"}," 作者 "),e("th",{scope:"col",class:"px-6 py-3 text-left font-medium text-gray-500 uppercase tracking-wider"}," 精選文章 "),e("th",{scope:"col",class:"px-6 py-3 font-medium text-gray-500 uppercase tracking-wider text-center"}," 確認動作 ")])],-1),D={class:"bg-white divide-y divide-gray-200"},E={class:"px-6 py-4 whitespace-nowrap text-gray-500"},L={class:"px-6 py-4 whitespace-nowrap text-gray-500"},M={class:"px-6 py-4 whitespace-nowrap text-gray-500"},N={class:"px-6 py-4 whitespace-nowrap text-gray-500"},T={class:"px-6 py-4 whitespace-nowrap text-gray-500"},F={class:"text-center"},P={class:"px-6 py-4 whitespace-nowrap text-gray-500 text-center"},U=["onClick"],W=f({__name:"BestArticle",setup(y){const n="https://islandofhealing.rocket-coding.com/api",{getAllArticles:d,reviewArticles:i}=v(),p=async(s,o)=>{const t=localStorage.getItem("token");if(t)try{const a=await(await fetch(`${n}/selectedarticle/${s}`,{method:"PUT",headers:{"Content-type":"application/json",Authorization:`Bearer ${t}`}})).json();if(a.StatusCode===200)a.Selected=o,u.fire("新增精選成功","該文章已被加入精選列表","success"),d();else throw new Error(`發生錯誤 ${a.Message}`)}catch(r){console.log(r)}},l=async(s,o)=>{const t=localStorage.getItem("token");if(t)try{const a=await(await fetch(`${n}/cancelselectedarticle/${s}`,{method:"PUT",headers:{"Content-type":"application/json",Authorization:`Bearer ${t}`}})).json();if(a.StatusCode===200)a.Selected=o,u.fire("刪除精選成功","該文章已被移除精選列表","success"),d();else throw new Error(`發生錯誤 ${a.Message}`)}catch(r){console.log(r)}},m=async s=>{const o=!s.Selected;o?await p(s.Id,o):await l(s.Id,o)};return _(d),(s,o)=>(g(),h("h1",null,[w(i)?(g(),h("div",$,[e("div",B,[e("div",C,[e("div",I,[e("table",j,[z,e("tbody",D,[(g(!0),h(k,null,b(w(i),t=>(g(),h("tr",{key:t.Id},[e("td",E,c(t.Id),1),e("td",L,c(t.Title),1),e("td",M,c(new Date(t.Initdate).toLocaleString()),1),e("td",N,c(t.WriterNickName),1),e("td",T,[e("p",F,c(t.Selected?"是":"否"),1)]),e("td",P,[e("button",{onClick:r=>m(t),class:S(["btn btn-sm border ml-2 p-2 h-9 rounded-md px-4 text-white font-normal",t.Selected?"bg-rose-700 hover:bg-rose-800":"bg-teal-600 hover:bg-teal-700"])},c(t.Selected?"刪除精選":"新增精選"),11,U)])]))),128))])])])])])])):A("",!0)]))}});export{W as default};
